console.log("[PROFILE HUB] Initializing modular ProfileHub system...");class l{constructor(){console.log("[PROFILE HUB] Creating ProfileHubManager..."),this.state={user:{isAuthenticated:!1,profile:null,preferences:this.getDefaultPreferences()},ui:{hubState:"minimized",chatbotState:"closed",customizationState:"closed",position:"top-right",theme:"neo-brutalist",scale:1},navigation:{currentPage:this.getCurrentPage(),history:[],bookmarks:[]},chatbot:{messages:[],isTyping:!1,commands:this.getQuickCommands()},notifications:{unreadCount:0,items:[]}},this.listeners=new Map,this.dom={},this.modules={auth:null,chatbot:null,customization:null,navigation:null},this.init()}async init(){console.log("[PROFILE HUB] Initializing ProfileHub system...");try{document.readyState==="loading"&&await new Promise(e=>{document.addEventListener("DOMContentLoaded",e)}),this.initializeDOMReferences(),await this.initializeModules(),this.setupEventListeners(),this.applySavedPreferences(),this.updateUI(),this.setupAuthListener(),console.log("[PROFILE HUB] ProfileHub initialization complete")}catch(e){console.error("[PROFILE HUB] Initialization failed:",e)}}initializeDOMReferences(){console.log("[PROFILE HUB] Initializing DOM references..."),this.dom={hub:document.getElementById("profileHub"),hubCore:document.querySelector(".hub-core"),expandedContent:document.getElementById("hubExpandedContent"),overlay:document.getElementById("profileHubOverlay"),userAvatar:document.getElementById("hubUserAvatar"),userName:document.getElementById("hubUserName"),userStatus:document.getElementById("hubUserStatus"),userLevel:document.getElementById("hubUserLevel"),statusIndicator:document.getElementById("hubStatusIndicator"),chatbotToggle:document.getElementById("hubChatbotToggle"),customizeToggle:document.getElementById("hubCustomizeToggle"),authToggle:document.getElementById("hubAuthToggle"),hubToggle:document.getElementById("hubToggleBtn"),drawerToggle:document.getElementById("profileHubDrawerToggle"),chatbotContainer:document.getElementById("hubChatbotContainer"),chatbotSlider:document.getElementById("chatbotSlider"),chatMessages:document.getElementById("hubChatMessages"),chatInput:document.getElementById("hubChatInput"),sendChatBtn:document.getElementById("hubSendChatBtn"),chatCommands:document.getElementById("hubChatCommands"),customizationPanel:document.getElementById("hubCustomizationPanel"),userStats:document.getElementById("hubUserStats"),notificationBadge:document.getElementById("hubNotificationBadge")};const t=["hub","hubCore","expandedContent"].filter(i=>!this.dom[i]);t.length>0&&console.error(`[PROFILE HUB] Missing required DOM elements: ${t.join(", ")}`),console.log("[PROFILE HUB] DOM elements found:"),Object.keys(this.dom).forEach(i=>{this.dom[i]?console.log(`  ✅ ${i}: Found`):console.log(`  ❌ ${i}: Missing`)}),console.log("[PROFILE HUB] DOM references initialized successfully - Enhanced sliding modal system ready")}async initializeModules(){console.log("[PROFILE HUB] Initializing modules..."),this.modules.auth=new g(this),this.modules.chatbot=new m(this),this.modules.customization=new p(this),this.modules.navigation=new b(this),console.log("[PROFILE HUB] All modules initialized")}setupEventListeners(){console.log("[PROFILE HUB] Setting up event listeners..."),this.dom.hubToggle?this.addEventListener(this.dom.hubToggle,"click",()=>{console.log("[PROFILE HUB] Hub toggle button clicked"),this.toggleHub()}):console.warn("[PROFILE HUB] Hub toggle button not found!"),this.dom.drawerToggle?this.addEventListener(this.dom.drawerToggle,"click",()=>{console.log("[PROFILE HUB] Drawer toggle button clicked"),this.toggleDrawer()}):console.warn("[PROFILE HUB] Drawer toggle button not found!"),this.dom.chatbotToggle?this.addEventListener(this.dom.chatbotToggle,"click",()=>{console.log("[PROFILE HUB] Chatbot toggle button clicked"),this.toggleChatbot()}):console.warn("[PROFILE HUB] Chatbot toggle button not found!"),this.dom.customizeToggle?this.addEventListener(this.dom.customizeToggle,"click",()=>{console.log("[PROFILE HUB] Gear quicklink clicked → navigating to Explore"),console.log("[PROFILE HUB] Navigating to: pages/explore.html"),window.location.href="pages/explore.html"}):console.warn("[PROFILE HUB] Customize toggle button not found!"),this.dom.authToggle?this.addEventListener(this.dom.authToggle,"click",()=>{console.log("[PROFILE HUB] Auth toggle button clicked"),this.modules.auth.handleAuthToggle()}):console.warn("[PROFILE HUB] Auth toggle button not found!"),this.addEventListener(this.dom.userAvatar,"click",()=>{this.handleUserAvatarClick()}),this.addEventListener(this.dom.overlay,"click",()=>{this.closeAllPanels()}),this.addEventListener(document,"keydown",i=>{this.handleKeyboardShortcuts(i)}),this.setupNavigationListeners(),this.setupQuickActionListeners(),this.addEventListener(window,"resize",()=>{this.handleResize()});const e=document.getElementById("adminOpenUsers"),t=document.getElementById("adminOpenRules");e&&this.addEventListener(e,"click",()=>{console.log("[PROFILE HUB][ADMIN] Opening Users page"),window.location.href="pages/users.html"}),t&&this.addEventListener(t,"click",()=>{console.log("[PROFILE HUB][ADMIN] Attempting to open Firestore rules");try{window.open("/firestore.rules","_blank")}catch(i){console.warn("[PROFILE HUB][ADMIN] Could not open rules in new tab",i)}}),console.log("[PROFILE HUB] Event listeners set up successfully")}setupNavigationListeners(){const e=this.dom.expandedContent?.querySelectorAll(".nav-link");e?(console.log(`[PROFILE HUB] Setting up ${e.length} navigation links`),e.forEach((t,i)=>{const n=t.getAttribute("href");console.log(`[PROFILE HUB] Link ${i+1}: ${n}`),this.addEventListener(t,"click",s=>{this.handleNavigation(s,t)})})):console.warn("[PROFILE HUB] No navigation links found in expanded content")}setupQuickActionListeners(){const e=this.dom.expandedContent?.querySelectorAll(".quick-action-btn");e&&e.forEach(t=>{this.addEventListener(t,"click",()=>{const i=t.dataset.action;this.handleQuickAction(i)})})}handleNavigation(e,t){const i=t.getAttribute("href"),n=i.startsWith("http");console.log(`[PROFILE HUB] Navigation requested: ${i}`),n||(e.preventDefault(),this.state.navigation.history.push({url:i,timestamp:Date.now(),title:t.textContent.trim()}),t.style.transform="scale(0.95)",setTimeout(()=>{t.style.transform=""},150),setTimeout(()=>{console.log(`[PROFILE HUB] Navigating to: ${i}`),window.location.href=i},200)),setTimeout(()=>{this.setState({ui:{hubState:"minimized"}})},100)}handleQuickAction(e){switch(console.log(`[PROFILE HUB] Quick action: ${e}`),e){case"newWidget":this.modules.navigation.openWidgetStudio();break;case"shareProfile":this.modules.navigation.shareProfile();break;case"notifications":this.modules.navigation.openNotifications();break;case"settings":this.toggleCustomization();break;default:console.warn(`[PROFILE HUB] Unknown action: ${e}`)}}handleKeyboardShortcuts(e){(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="H"&&(e.preventDefault(),this.toggleHub()),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="C"&&(e.preventDefault(),this.toggleChatbot()),e.key==="Escape"&&this.closeAllPanels(),(e.ctrlKey||e.metaKey)&&e.shiftKey&&e.key==="D"&&(e.preventDefault(),this.toggleDrawer())}handleResize(){this.adjustHubPosition()}handleUserAvatarClick(){this.state.user.isAuthenticated?this.toggleHub():this.modules.auth.openAuthModal()}toggleHub(){const t=this.state.ui.hubState==="expanded"?"minimized":"expanded";console.log(`[PROFILE HUB] Toggling hub: ${this.state.ui.hubState} -> ${t}`),this.dom.expandedContent?(console.log("[PROFILE HUB] Expanded content element found:",this.dom.expandedContent),console.log("[PROFILE HUB] Current expanded content display:",window.getComputedStyle(this.dom.expandedContent).display)):console.warn("[PROFILE HUB] Expanded content element NOT found!"),this.setState({ui:{hubState:t,customizationState:"closed"}}),setTimeout(()=>{console.log("[PROFILE HUB] State after toggle:",this.state.ui.hubState),this.dom.hub&&console.log("[PROFILE HUB] Hub data-state attribute:",this.dom.hub.getAttribute("data-state")),this.dom.expandedContent&&console.log("[PROFILE HUB] Expanded content display after toggle:",window.getComputedStyle(this.dom.expandedContent).display)},100)}toggleDrawer(){const e=this.dom.hub.classList.contains("drawer-hidden");console.log(`[PROFILE HUB] Toggling drawer: ${e?"showing":"hiding"}`),e?(this.dom.hub.classList.remove("drawer-hidden"),this.dom.drawerToggle.style.display="none",console.log("[PROFILE HUB] ProfileHub drawer shown")):(this.dom.hub.classList.add("drawer-hidden"),this.dom.drawerToggle.style.display="flex",console.log("[PROFILE HUB] ProfileHub drawer hidden"))}toggleChatbot(){const e=this.state.ui.hubState==="chatbot-active",t=e?"minimized":"chatbot-active";console.log(`[PROFILE HUB] Toggling chatbot: ${this.state.ui.hubState} -> ${t}`),console.log("[PROFILE HUB] Enhanced chatbot sliding animation triggered - smooth slide from right"),this.setState({ui:{hubState:t,customizationState:"closed"}}),e||this.modules.chatbot.initialize()}toggleCustomization(){const e=this.state.ui.customizationState==="open",t=e?"closed":"open";console.log(`[PROFILE HUB] Toggling customization: ${this.state.ui.customizationState} -> ${t}`),console.log("[PROFILE HUB] Enhanced sliding modal animation triggered - smooth slide from right"),console.log("[PROFILE HUB] Orb remains visible and accessible in top-left corner"),this.setState({ui:{customizationState:t,hubState:e?"minimized":"expanded"}}),this.toggleCustomizationBackdrop(t==="open"),console.log("[PROFILE HUB] Customization panel state updated successfully")}toggleCustomizationBackdrop(e){let t=document.getElementById("hub-customization-panel-backdrop");t||(t=document.createElement("div"),t.id="hub-customization-panel-backdrop",t.className="hub-customization-panel-backdrop",t.addEventListener("click",()=>{this.toggleCustomization()}),document.body.appendChild(t),console.log("[PROFILE HUB] Created customization panel backdrop")),e?(t.classList.add("active"),console.log("[PROFILE HUB] Enhanced backdrop overlay activated with sliding animation")):(t.classList.remove("active"),console.log("[PROFILE HUB] Enhanced backdrop overlay deactivated"))}closeAllPanels(){console.log("[PROFILE HUB] Closing all panels"),this.setState({ui:{hubState:"minimized",customizationState:"closed"}})}updateUI(){if(!this.dom.hub)return;const{ui:e,user:t,notifications:i}=this.state;if(this.dom.hub.setAttribute("data-state",e.hubState),this.dom.hub.setAttribute("data-theme",e.theme),this.dom.hub.setAttribute("data-position",e.position),this.dom.hub.style.setProperty("--hub-scale",e.scale),this.dom.expandedContent&&(e.hubState==="expanded"?(this.dom.expandedContent.classList.add("show"),this.dom.expandedContent.style.display="block",this.dom.expandedContent.style.opacity="1",this.dom.expandedContent.style.visibility="visible",console.log("[PROFILE HUB] Expanded content forced to show")):(this.dom.expandedContent.classList.remove("show"),this.dom.expandedContent.style.display="none",this.dom.expandedContent.style.opacity="0",this.dom.expandedContent.style.visibility="hidden",console.log("[PROFILE HUB] Expanded content forced to hide"))),this.dom.overlay&&this.dom.overlay.classList.toggle("active",e.hubState==="expanded"||e.hubState==="chatbot-active"||e.customizationState==="open"),this.updateUserInfo(),this.updateNotificationBadge(),this.dom.customizationPanel){const n=e.customizationState==="open",s=this.dom.customizationPanel.classList.contains("active");this.dom.customizationPanel.classList.remove("slide-in","slide-out"),n&&!s?(this.dom.customizationPanel.classList.add("active","slide-in"),console.log("[PROFILE HUB] Customization panel sliding in with enhanced animation")):!n&&s?(this.dom.customizationPanel.classList.add("slide-out"),setTimeout(()=>{this.dom.customizationPanel.classList.remove("active","slide-out")},400),console.log("[PROFILE HUB] Customization panel sliding out with enhanced animation")):n&&this.dom.customizationPanel.classList.add("active")}if(this.dom.chatbotContainer){const n=e.hubState==="chatbot-active",s=this.dom.chatbotContainer.classList.contains("active");this.dom.chatbotContainer.classList.remove("slide-in","slide-out"),n&&!s?(this.dom.chatbotContainer.classList.add("active","slide-in"),console.log("[PROFILE HUB] Chatbot container sliding in with enhanced animation")):!n&&s?(this.dom.chatbotContainer.classList.add("slide-out"),setTimeout(()=>{this.dom.chatbotContainer.classList.remove("active","slide-out")},400),console.log("[PROFILE HUB] Chatbot container sliding out with enhanced animation")):n&&this.dom.chatbotContainer.classList.add("active")}console.log("[PROFILE HUB] UI updated with enhanced sliding modal animations")}updateUserInfo(){const{user:e}=this.state;this.dom.userName&&(this.dom.userName.textContent=e.isAuthenticated?e.profile?.displayName||e.profile?.name||"User":"Guest"),this.dom.userStatus&&(this.dom.userStatus.textContent=e.isAuthenticated?"Online • Authenticated":"Click to customize"),this.dom.userLevel&&(this.dom.userLevel.textContent=e.isAuthenticated?`LVL • ${e.profile?.level||1}`:"LVL • ?"),this.dom.statusIndicator&&(this.dom.statusIndicator.className=`avatar-status-indicator ${e.isAuthenticated?"online":"offline"}`),this.dom.authToggle&&(this.dom.authToggle.classList.toggle("logged-in",e.isAuthenticated),this.dom.authToggle.querySelector(".btn-icon").textContent=e.isAuthenticated?"👤":"🔐"),this.dom.userStats&&(this.dom.userStats.style.display=e.isAuthenticated?"block":"none");const t=document.getElementById("hubAdminSettings");if(t){const i=(e.profile?.role||"").toString().toUpperCase();t.style.display=e.isAuthenticated&&(i==="ADMIN"||i==="SUPERADMIN")?"block":"none";const n=document.getElementById("adminRoleLabel");n&&i&&(n.textContent=i)}if(this.dom.adminSection){const i=(e.profile?.role||"").toString().toUpperCase();this.dom.adminSection.style.display=e.isAuthenticated&&(i==="ADMIN"||i==="SUPERADMIN")?"block":"none";const n=document.getElementById("adminRoleLabel");n&&i&&(n.textContent=i)}console.log("[PROFILE HUB] User info updated")}updateNotificationBadge(){const{notifications:e}=this.state;this.dom.notificationBadge&&(this.dom.notificationBadge.textContent=e.unreadCount,this.dom.notificationBadge.style.display=e.unreadCount>0?"flex":"none")}updateUserStats(e){console.log("[PROFILE HUB] Updating user stats",e);const t=document.getElementById("hubWidgetCount"),i=document.getElementById("hubFollowerCount"),n=document.getElementById("hubViewCount");t&&(t.textContent=e.widgetsCreated||0),i&&(i.textContent=e.followersCount||0),n&&(n.textContent=e.totalViews||0),console.log("[PROFILE HUB] User stats updated successfully")}setupAuthListener(){window.addEventListener("auth-state-changed",e=>{const{user:t,profile:i}=e.detail;this.handleAuthStateChange(t,i)})}handleAuthStateChange(e,t=null){console.log("[PROFILE HUB] Auth state changed:",e?"logged in":"logged out",t?"with profile data":"without profile data"),this.setState({user:{isAuthenticated:!!e,profile:t||(e?this.extractUserProfile(e):null)}}),t&&t.stats&&this.updateUserStats(t.stats)}extractUserProfile(e){return{uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,name:e.displayName||e.email?.split("@")[0],level:1}}setState(e,t=!0){this.state=this.deepMerge(this.state,e),this.updateUI(),e.ui?.position&&this.handlePositionChange(e.ui.position),t&&e.user?.preferences&&this.savePreferences(),this.emit("state-changed",{state:this.state,changes:e}),console.log("[PROFILE HUB] State updated:",e)}deepMerge(e,t){const i={...e};for(const n in t)t[n]&&typeof t[n]=="object"&&!Array.isArray(t[n])?i[n]=this.deepMerge(i[n]||{},t[n]):i[n]=t[n];return i}addEventListener(e,t,i){if(!e)return;e.addEventListener(t,i);const n=`${t}-${Date.now()}-${Math.random()}`;return this.listeners.set(n,{element:e,event:t,handler:i}),n}removeEventListener(e){const t=this.listeners.get(e);t&&(t.element.removeEventListener(t.event,t.handler),this.listeners.delete(e))}emit(e,t){const i=new CustomEvent(`profilehub-${e}`,{detail:t});window.dispatchEvent(i)}getCurrentPage(){return window.location.pathname.split("/").pop()||"index.html"}getDefaultPreferences(){return{theme:"neo-brutalist",position:"top-right",scale:1,autoMinimize:!0,chatbotEnabled:!0,keyboardShortcuts:!0,animations:!0}}getQuickCommands(){return[{command:"/navigate projects",label:"🔗 Projects",action:"navigate",target:"pages/my-projects.html"},{command:"/help customize",label:"⚙️ Customize",action:"customize",target:null},{command:"/stats",label:"📊 Stats",action:"stats",target:null},{command:"/help",label:"❓ Help",action:"help",target:null}]}savePreferences(){try{localStorage.setItem("profilehub-preferences",JSON.stringify(this.state.user.preferences)),console.log("[PROFILE HUB] Preferences saved")}catch(e){console.warn("[PROFILE HUB] Failed to save preferences:",e)}}applySavedPreferences(){try{const e=localStorage.getItem("profilehub-preferences");if(e){const t=JSON.parse(e);this.setState({user:{preferences:t},ui:{theme:t.theme||"neo-brutalist",position:t.position||"top-right",scale:t.scale||1}},!1),console.log("[PROFILE HUB] Preferences applied")}}catch(e){console.warn("[PROFILE HUB] Failed to load preferences:",e)}}adjustHubPosition(){const e=this.dom.hub.getBoundingClientRect();(e.right>window.innerWidth||e.bottom>window.innerHeight)&&console.log("[PROFILE HUB] Adjusting position for viewport")}handlePositionChange(e){console.log("[PROFILE HUB] Handling position change to:",e),this.updateModalPositions(e),this.emit("position-changed",{position:e,previousPosition:this.state.ui.position}),this.repositionOpenModals(e)}updateModalPosition(e,t){e&&(Object.keys(t).forEach(i=>{e.style[i]=t[i]}),e.className=e.className.replace(/position-\w+/g,""),e.classList.add(`position-${this.state.ui.position}`))}repositionOpenModals(e){const{ui:t}=this.state;t.hubState==="expanded"&&this.dom.expandedContent&&this.updateModalPositions(e),t.hubState==="chatbot-active"&&this.dom.chatbotContainer&&this.updateModalPositions(e),t.customizationState==="open"&&this.dom.customizationPanel&&this.updateModalPositions(e)}destroy(){console.log("[PROFILE HUB] Destroying ProfileHub..."),this.listeners.forEach((e,t)=>{this.removeEventListener(t)}),Object.values(this.modules).forEach(e=>{e&&typeof e.destroy=="function"&&e.destroy()}),console.log("[PROFILE HUB] ProfileHub destroyed")}}class g{constructor(e){this.hub=e,console.log("[AUTH MODULE] Initialized")}handleAuthToggle(){this.hub.state.user.isAuthenticated?this.openProfileMenu():this.openAuthModal()}openAuthModal(){if(console.log("[AUTH MODULE] Opening auth modal..."),window.openAuthModal)window.openAuthModal("login");else{const e=document.getElementById("authModal");e&&(e.style.display="block",document.body.style.overflow="hidden")}this.hub.setState({ui:{hubState:"minimized"}})}openProfileMenu(){console.log("[AUTH MODULE] Opening profile menu..."),this.hub.toggleHub()}}class m{constructor(e){this.hub=e,this.initialized=!1,console.log("[CHATBOT MODULE] Initialized")}initialize(){this.initialized||(console.log("[CHATBOT MODULE] Setting up chatbot integration..."),this.setupChatbotListeners(),this.loadChatHistory(),this.setupQuickCommands(),this.initialized=!0,console.log("[CHATBOT MODULE] Chatbot integration ready"))}setupChatbotListeners(){const{dom:e}=this.hub;this.hub.addEventListener(e.sendChatBtn,"click",()=>{this.sendMessage()}),this.hub.addEventListener(e.chatInput,"keypress",s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),this.sendMessage())});const t=e.chatCommands?.querySelectorAll(".command-chip");t&&t.forEach(s=>{this.hub.addEventListener(s,"click",()=>{const r=s.dataset.command;this.executeCommand(r)})});const i=e.chatbotSlider?.querySelector("#chatbotClose"),n=e.chatbotSlider?.querySelector("#chatbotMinimize");i&&this.hub.addEventListener(i,"click",()=>{this.hub.setState({ui:{hubState:"minimized"}})}),n&&this.hub.addEventListener(n,"click",()=>{this.hub.setState({ui:{hubState:"expanded"}})})}async sendMessage(){const{dom:e}=this.hub,t=e.chatInput?.value.trim();if(t){if(console.log("[CHATBOT MODULE] Sending message:",t),e.chatInput.value="",this.addMessage(t,"user"),t.startsWith("/")){this.executeCommand(t);return}this.showTypingIndicator();try{const i=await this.getAIResponse(t);this.hideTypingIndicator(),this.addMessage(i,"ai")}catch(i){console.error("[CHATBOT MODULE] Error getting AI response:",i),this.hideTypingIndicator(),this.addMessage("Sorry, I encountered an error. Please try again.","ai")}}}addMessage(e,t){const{dom:i}=this.hub;if(!i.chatMessages)return;const n=document.createElement("div");n.className=`message ${t}-message`,n.innerHTML=`
      <div class="message-avatar">${t==="user"?"👤":"🤖"}</div>
      <div class="message-content">
        <p>${e}</p>
      </div>
    `,i.chatMessages.appendChild(n),i.chatMessages.scrollTop=i.chatMessages.scrollHeight,this.hub.setState({chatbot:{messages:[...this.hub.state.chatbot.messages,{content:e,sender:t,timestamp:Date.now()}]}}),console.log(`[CHATBOT MODULE] Added ${t} message`)}showTypingIndicator(){const{dom:e}=this.hub;if(!e.chatMessages)return;const t=document.createElement("div");t.className="message ai-message typing",t.id="hubTypingIndicator",t.innerHTML=`
      <div class="message-avatar">🤖</div>
      <div class="message-content">
        <p>Thinking...</p>
      </div>
    `,e.chatMessages.appendChild(t),e.chatMessages.scrollTop=e.chatMessages.scrollHeight,this.hub.setState({chatbot:{isTyping:!0}})}hideTypingIndicator(){const e=document.getElementById("hubTypingIndicator");e&&e.remove(),this.hub.setState({chatbot:{isTyping:!1}})}async getAIResponse(e){try{const t=this.getContextualResponse(e);return t||(window.getAIResponse?await window.getAIResponse(e):this.getFallbackResponse(e))}catch(t){return console.error("[CHATBOT MODULE] AI response error:",t),"I'm here to help you navigate and customize your ProfileHub experience. What would you like to know?"}}getContextualResponse(e){const t=e.toLowerCase();return t.includes("navigate")||t.includes("go to")?"I can help you navigate! Use commands like '/navigate projects' to go to your projects, or click the navigation links in your expanded hub.":t.includes("customize")||t.includes("theme")?"To customize your ProfileHub, click the gear icon or use '/help customize'. You can change themes, colors, position, and more!":t.includes("stats")||t.includes("profile")?"Your profile stats show your widgets, followers, and views. Use '/stats' to see detailed information about your account.":null}getFallbackResponse(e){const t=["I'm your integrated AI assistant! I can help you navigate, customize your hub, and answer questions about the platform.","Try using commands like '/navigate projects' or '/help customize' for quick actions!","I can help you understand ProfileHub features. What would you like to explore?","Your ProfileHub is fully customizable! Ask me about themes, positioning, or navigation."];return t[Math.floor(Math.random()*t.length)]}executeCommand(e){console.log("[CHATBOT MODULE] Executing command:",e);const t=e.split(" "),i=t[0].substring(1),n=t.slice(1).join(" ");switch(i){case"navigate":this.executeNavigateCommand(n);break;case"help":this.executeHelpCommand(n);break;case"stats":this.executeStatsCommand();break;case"customize":this.executeCustomizeCommand();break;default:this.addMessage(`Unknown command: ${e}. Try '/help' for available commands.`,"ai")}}executeNavigateCommand(e){const t={projects:"pages/profile_dashboard/my-projects.html",studio:"pages/profile_dashboard/widget_studio.html",explore:"pages/explore.html",community:"pages/users.html"};t[e]?(this.addMessage(`Navigating to ${e}...`,"ai"),setTimeout(()=>{window.location.href=t[e]},1e3)):this.addMessage(`Available navigation targets: ${Object.keys(t).join(", ")}`,"ai")}executeHelpCommand(e){e==="customize"?(this.addMessage("To customize your ProfileHub: Click the gear icon, choose themes, adjust colors and position. Your changes are saved automatically!","ai"),this.hub.toggleCustomization()):this.addMessage(`Available commands:
      • /navigate [projects|studio|explore|community]
      • /help [customize]
      • /stats
      • /customize`,"ai")}executeStatsCommand(){const{user:e}=this.hub.state;e.isAuthenticated?this.addMessage(`Your Stats:
      • Level: ${e.profile?.level||1}
      • Widgets: ${e.profile?.stats?.widgetsCreated||0}
      • Followers: ${e.profile?.stats?.followersCount||0}
      • Views: ${e.profile?.stats?.totalViews||0}`,"ai"):this.addMessage("Please log in to view your stats!","ai")}executeCustomizeCommand(){this.addMessage("Opening customization panel...","ai"),this.hub.toggleCustomization()}setupQuickCommands(){}loadChatHistory(){try{const e=localStorage.getItem("profilehub-chat-history");if(e){const t=JSON.parse(e);this.hub.setState({chatbot:{messages:t}},!1),t.forEach(i=>{this.addMessage(i.content,i.sender)})}}catch(e){console.warn("[CHATBOT MODULE] Failed to load chat history:",e)}}}class p{constructor(e){this.hub=e,this.setupCustomizationControls(),console.log("[CUSTOMIZATION MODULE] Initialized")}setupCustomizationControls(){const e=document.getElementById("hubCustomizationPanel");if(!e)return;e.querySelectorAll(".theme-option").forEach(c=>{this.hub.addEventListener(c,"click",()=>{this.setTheme(c.dataset.theme)})});const i=e.querySelector("#hubPrimaryColor");i&&this.hub.addEventListener(i,"change",c=>{this.setPrimaryColor(c.target.value)});const n=e.querySelector("#hubSize");n&&this.hub.addEventListener(n,"input",c=>{this.setSize(parseFloat(c.target.value))});const s=e.querySelector("#saveCustomization"),r=e.querySelector("#resetCustomization");s&&this.hub.addEventListener(s,"click",()=>{this.saveCustomization()}),r&&this.hub.addEventListener(r,"click",()=>{this.resetCustomization()})}setTheme(e){console.log("[CUSTOMIZATION MODULE] Setting theme:",e),this.hub.setState({ui:{theme:e},user:{preferences:{theme:e}}}),document.querySelectorAll(".theme-option").forEach(t=>{t.classList.toggle("active",t.dataset.theme===e)})}setPrimaryColor(e){console.log("[CUSTOMIZATION MODULE] Setting primary color:",e),this.hub.dom.hub.style.setProperty("--hub-primary",e),this.hub.setState({user:{preferences:{primaryColor:e}}})}setSize(e){console.log("[CUSTOMIZATION MODULE] Setting size:",e),this.hub.setState({ui:{scale:e},user:{preferences:{scale:e}}})}saveCustomization(){this.hub.savePreferences(),this.showCustomizationToast("Customization saved!","success")}resetCustomization(){const e=this.hub.getDefaultPreferences();this.hub.setState({ui:{theme:e.theme,position:e.position,scale:e.scale},user:{preferences:e}}),this.updateCustomizationUI(),this.showCustomizationToast("Customization reset to defaults","info")}updateCustomizationUI(){const{ui:e}=this.hub.state;document.querySelectorAll(".theme-option").forEach(i=>{i.classList.toggle("active",i.dataset.theme===e.theme)}),document.getElementById("hubPrimaryColor");const t=document.getElementById("hubSize");t&&(t.value=e.scale)}showCustomizationToast(e,t){window.socialAuth&&window.socialAuth.showToast?window.socialAuth.showToast(e,t):console.log(`[CUSTOMIZATION MODULE] ${e}`)}}class b{constructor(e){this.hub=e,console.log("[NAVIGATION MODULE] Initialized")}openWidgetStudio(){console.log("[NAVIGATION MODULE] Opening Widget Studio..."),window.openWidgetStudio?window.openWidgetStudio():window.location.href="pages/profile_dashboard/widget_studio.html",this.hub.setState({ui:{hubState:"minimized"}})}shareProfile(){console.log("[NAVIGATION MODULE] Sharing profile...");const e=window.location.href;navigator.share?navigator.share({title:"Check out my profile!",url:e}):navigator.clipboard&&(navigator.clipboard.writeText(e),this.showNavigationToast("Profile URL copied to clipboard!","success"))}openNotifications(){console.log("[NAVIGATION MODULE] Opening notifications..."),window.openNotificationsPanel?window.openNotificationsPanel():this.showNavigationToast("Notifications panel coming soon!","info")}showNavigationToast(e,t){window.socialAuth&&window.socialAuth.showToast&&window.socialAuth.showToast(e,t)}}async function f(){try{console.log("[PROFILE HUB] Loading ProfileHub HTML content..."),await new Promise(n=>setTimeout(n,100));const o=["pages/page_modals/profile_banner.html","./pages/page_modals/profile_banner.html","/pages/page_modals/profile_banner.html"];let e=null,t=null;for(const n of o)try{console.log(`[PROFILE HUB] Trying to load from: ${n}`);const s=await fetch(n);if(s.ok){e=await s.text(),console.log(`[PROFILE HUB] Successfully loaded HTML from: ${n}`);break}else t=new Error(`Failed to load ProfileHub HTML from ${n}: ${s.status}`)}catch(s){t=s,console.warn(`[PROFILE HUB] Failed to load from ${n}:`,s.message)}if(!e)throw t||new Error("Failed to load ProfileHub HTML from any path");const i=document.getElementById("profileHubContainer");i?(i.innerHTML=e,console.log("[PROFILE HUB] ProfileHub HTML content loaded successfully"),console.log("[PROFILE HUB] HTML loaded, ready for manager initialization")):(console.warn("[PROFILE HUB] ProfileHub container not found"),h())}catch(o){console.error("[PROFILE HUB] Error loading ProfileHub HTML:",o),d()}}async function E(){try{if(document.getElementById("authModal"))return;const o=["pages/page_modals/user_auth.html","./pages/page_modals/user_auth.html","/pages/page_modals/user_auth.html"];let e=null,t=null;for(const n of o)try{const s=await fetch(n);if(s.ok){e=await s.text();break}else t=new Error(`Failed to load Auth Modal HTML from ${n}: ${s.status}`)}catch(s){t=s}if(!e)throw t||new Error("Auth Modal HTML load failed");const i=document.createElement("div");i.innerHTML=e,document.body.appendChild(i),console.log("[PROFILE HUB] Auth modal HTML injected")}catch(o){console.warn("[PROFILE HUB] Could not inject Auth modal:",o)}}function h(){if(document.getElementById("profileHubContainer")){console.log("[PROFILE HUB] Container already exists");return}const o=document.createElement("div");return o.id="profileHubContainer",o.style.position="fixed",o.style.top="20px",o.style.right="20px",o.style.zIndex="100080",o.style.pointerEvents="auto",o.style.transition="all 0.3s ease",document.body.appendChild(o),console.log("[PROFILE HUB] Created ProfileHub container"),o}function d(){console.log("[PROFILE HUB] Creating fallback ProfileHub structure...");const o=document.getElementById("profileHubContainer");o&&(o.innerHTML=`
    <button id="profileHubDrawerToggle" class="profile-hub-drawer-toggle" style="display: none;" title="Show Profile Hub">
      👤
    </button>
    <div id="profileHub" class="profile-hub" data-state="minimized">
      <div class="hub-core">
        <div class="hub-user-section">
          <div class="user-avatar-container">
            <div id="hubUserAvatar" class="hub-user-avatar">
              <span class="avatar-emoji">👤</span>
              <div class="avatar-status-indicator" id="hubStatusIndicator"></div>
            </div>
          </div>
          <div class="hub-user-info">
            <div id="hubUserName" class="hub-user-name">Guest</div>
            <div id="hubUserStatus" class="hub-user-status">Click to customize</div>
            <div id="hubUserLevel" class="hub-user-level">LVL • ?</div>
          </div>
        </div>
        <div class="hub-controls">
          <button id="hubChatbotToggle" class="hub-control-btn" title="AI Assistant">
            <span class="btn-icon">🤖</span>
            <span class="btn-pulse" id="chatbotPulse"></span>
          </button>
          <button id="hubCustomizeToggle" class="hub-control-btn" title="Explore">
            <span class="btn-icon">⚙️</span>
          </button>
          <button id="hubAuthToggle" class="hub-control-btn hub-auth-btn" title="Login / Profile">
            <span class="btn-icon">🔐</span>
          </button>
        </div>
        <button id="hubToggleBtn" class="hub-toggle-btn" title="Expand Hub">
          <span class="toggle-icon">⫷</span>
        </button>
      </div>
      <div class="hub-expanded-content" id="hubExpandedContent">
        <div class="hub-navigation">
          <h3 class="nav-section-title">Navigate</h3>
          <div class="nav-links-grid">
            <a href="pages/profile_dashboard/my-projects.html" class="nav-link" data-color="primary">
              <span class="nav-icon">📊</span>
              <span class="nav-label">Projects</span>
            </a>
            <a href="pages/profile_dashboard/widget_studio.html" class="nav-link" data-color="secondary">
              <span class="nav-icon">🎨</span>
              <span class="nav-label">Studio</span>
            </a>
            <a href="pages/explore.html" class="nav-link" data-color="accent">
              <span class="nav-icon">🔍</span>
              <span class="nav-label">Explore</span>
            </a>
            <a href="pages/users.html" class="nav-link" data-color="success">
              <span class="nav-icon">👥</span>
              <span class="nav-label">Community</span>
            </a>
          </div>
        </div>
        <div class="hub-quick-actions">
          <h3 class="nav-section-title">Quick Actions</h3>
          <div class="quick-actions-grid">
            <button class="quick-action-btn" data-action="newWidget">
              <span class="action-icon">➕</span>
              <span class="action-label">New Widget</span>
            </button>
            <button class="quick-action-btn" data-action="shareProfile">
              <span class="action-icon">🔗</span>
              <span class="action-label">Share</span>
            </button>
            <button class="quick-action-btn" data-action="notifications">
              <span class="action-icon">🔔</span>
              <span class="action-label">Notifications</span>
              <span class="notification-badge" id="hubNotificationBadge">0</span>
            </button>
            <button class="quick-action-btn" data-action="settings">
              <span class="action-icon">⚙️</span>
              <span class="action-label">Settings</span>
            </button>
          </div>
        </div>
        <div class="hub-user-stats" id="hubUserStats" style="display: none;">
          <h3 class="nav-section-title">Stats</h3>
          <div class="stats-grid">
            <div class="stat-item">
              <span class="stat-value" id="hubWidgetCount">0</span>
              <span class="stat-label">Widgets</span>
            </div>
            <div class="stat-item">
              <span class="stat-value" id="hubFollowerCount">0</span>
              <span class="stat-label">Followers</span>
            </div>
            <div class="stat-item">
              <span class="stat-value" id="hubViewCount">0</span>
              <span class="stat-label">Views</span>
            </div>
          </div>
        </div>
      </div>
      <div class="hub-chatbot-container" id="hubChatbotContainer">
        <div class="chatbot-slider" id="chatbotSlider">
          <div class="chatbot-header">
            <div class="chatbot-title">
              <span class="chatbot-icon">🤖</span>
              <span>AI Assistant</span>
            </div>
            <div class="chatbot-controls">
              <button id="chatbotMinimize" class="chatbot-control-btn" title="Minimize">−</button>
              <button id="chatbotClose" class="chatbot-control-btn" title="Close">×</button>
            </div>
          </div>
          <div class="chatbot-content">
            <div class="chat-messages" id="hubChatMessages">
              <div class="message ai-message">
                <div class="message-avatar">🤖</div>
                <div class="message-content">
                  <p>Hi! I'm your AI assistant integrated into your ProfileHub. How can I help you navigate or customize your experience?</p>
                </div>
              </div>
            </div>
            <div class="chat-input-container">
              <input type="text" id="hubChatInput" class="chat-input" placeholder="Ask me anything..." maxlength="500">
              <button id="hubSendChatBtn" class="send-chat-btn">
                <span class="btn-icon">📤</span>
              </button>
            </div>
            <div class="chat-quick-commands" id="hubChatCommands">
              <button class="command-chip" data-command="/navigate projects">🔗 Projects</button>
              <button class="command-chip" data-command="/help customize">⚙️ Customize</button>
              <button class="command-chip" data-command="/stats">📊 Stats</button>
              <button class="command-chip" data-command="/help">❓ Help</button>
            </div>
          </div>
        </div>
      </div>
      <div class="hub-customization-panel" id="hubCustomizationPanel">
        <div class="customization-content">
          <h3>Customize Your Hub</h3>
          <div class="customization-section">
            <label class="section-label">Theme</label>
            <div class="theme-selector">
              <button class="theme-option active" data-theme="neo-brutalist">Neo</button>
              <button class="theme-option" data-theme="minimal">Minimal</button>
              <button class="theme-option" data-theme="cyberpunk">Cyber</button>
              <button class="theme-option" data-theme="custom">Custom</button>
            </div>
          </div>
          <div class="customization-section">
            <label class="section-label">Primary Color</label>
            <input type="color" id="hubPrimaryColor" class="color-picker" value="#00f0ff">
          </div>
          <div class="customization-section">
            <label class="section-label">Hub Size</label>
            <input type="range" id="hubSize" class="size-slider" min="0.8" max="1.5" step="0.1" value="1">
          </div>
          <div class="customization-actions">
            <button id="saveCustomization" class="save-btn">Save Changes</button>
            <button id="resetCustomization" class="reset-btn">Reset</button>
          </div>
        </div>
      </div>
    </div>
    <div id="profileHubOverlay" class="profile-hub-overlay"></div>
  `,console.log("[PROFILE HUB] Fallback ProfileHub structure created"))}let a=null;async function u(){console.log("[PROFILE HUB] Starting ProfileHub system initialization...");try{let o=document.getElementById("profileHubContainer");if(!o&&(console.log("[PROFILE HUB] Creating ProfileHub container..."),h(),await new Promise(e=>setTimeout(e,100)),o=document.getElementById("profileHubContainer"),!o))throw new Error("Failed to create ProfileHub container");return y(),await f(),await E(),await new Promise(e=>setTimeout(e,200)),a=new l,await a.init(),window.profileHubManager=a,H(),console.log("[PROFILE HUB] ProfileHub system ready!"),!0}catch(o){console.error("[PROFILE HUB] Failed to initialize ProfileHub:",o),console.log("[PROFILE HUB] Attempting fallback initialization...");try{return d(),await new Promise(e=>setTimeout(e,100)),a=new l,window.profileHubManager=a,console.log("[PROFILE HUB] Fallback initialization successful!"),!0}catch(e){return console.error("[PROFILE HUB] Fallback initialization also failed:",e),!1}}}document.addEventListener("DOMContentLoaded",async()=>{console.log("[PROFILE HUB] DOM ready, initializing ProfileHub..."),await u()});window.debugProfileHub=function(){console.log("=== PROFILE HUB DEBUG ==="),console.log("Container exists:",!!document.getElementById("profileHubContainer")),console.log("ProfileHub element exists:",!!document.getElementById("profileHub")),console.log("ProfileHub Manager exists:",!!window.profileHubManager),console.log("Container HTML:",document.getElementById("profileHubContainer")?.innerHTML?.length||"No container"),console.log("Container position:",document.getElementById("profileHubContainer")?.style?.position||"No styles");const o={hubToggle:document.getElementById("hubToggleBtn"),chatbotToggle:document.getElementById("hubChatbotToggle"),customizeToggle:document.getElementById("hubCustomizeToggle"),authToggle:document.getElementById("hubAuthToggle"),userAvatar:document.getElementById("hubUserAvatar")};return console.log("Button elements found:"),Object.entries(o).forEach(([e,t])=>{t?(console.log(`  ✅ ${e}: Found`,t),console.log(`     - Clickable: ${t.style.pointerEvents!=="none"}`),console.log(`     - Visible: ${t.offsetParent!==null}`)):console.log(`  ❌ ${e}: Not found`)}),document.getElementById("profileHub")||(console.log("ProfileHub not found, attempting to reinitialize..."),u()),{container:!!document.getElementById("profileHubContainer"),profileHub:!!document.getElementById("profileHub"),manager:!!window.profileHubManager,buttons:o}};window.toggleProfileHub=()=>a?.toggleHub();window.toggleProfileChatbot=()=>a?.toggleChatbot();window.openProfileCustomization=()=>a?.toggleCustomization();window.toggleProfileHubDrawer=()=>a?.toggleDrawer();window.resetProfileBannerPosition=(o="top-right")=>{console.log("[PROFILE HUB DEBUG] Resetting position to:",o),a?(a.setState({ui:{position:o},user:{preferences:{position:o}}}),a.updateUI(),console.log("[PROFILE HUB DEBUG] Position reset complete")):console.warn("[PROFILE HUB DEBUG] ProfileHub manager not available")};window.forceShowProfileHub=()=>{if(console.log("[PROFILE HUB DEBUG] Forcing ProfileHub to show"),!document.getElementById("profileHubContainer")){console.error("[PROFILE HUB DEBUG] ProfileHub container not found!");return}const e=document.getElementById("profileHub");if(!e){console.error("[PROFILE HUB DEBUG] ProfileHub element not found! Creating fallback..."),d(),a||(console.log("[PROFILE HUB DEBUG] Creating ProfileHub manager..."),a=new l,window.profileHubManager=a);return}if(e.style.display="block",e.style.opacity="1",e.style.visibility="visible",e.style.zIndex="1000",e.style.position="fixed",e.style.top="20px",e.style.right="20px",console.log("[PROFILE HUB DEBUG] ProfileHub forced to show"),!a){console.log("[PROFILE HUB DEBUG] Initializing ProfileHub manager...");try{a=new l,window.profileHubManager=a,console.log("[PROFILE HUB DEBUG] ProfileHub manager initialized")}catch(t){console.error("[PROFILE HUB DEBUG] Failed to initialize ProfileHub manager:",t)}}};window.checkProfileHubStatus=()=>{console.log("[PROFILE HUB DEBUG] Checking ProfileHub status...");const o={container:!!document.getElementById("profileHubContainer"),profileHub:!!document.getElementById("profileHub"),manager:!!a,managerState:a?.state||null,cssLoaded:!!document.querySelector('link[href*="profile_banner.css"]'),scriptLoaded:!!window.ProfileHubEvents};return console.log("[PROFILE HUB DEBUG] Status:",o),o};window.ProfileHubEvents={onPositionChange:o=>{const e=t=>{o(t.detail)};return window.addEventListener("profilehub-position-changed",e),()=>{window.removeEventListener("profilehub-position-changed",e)}},onStateChange:o=>{const e=t=>{o(t.detail)};return window.addEventListener("profilehub-state-changed",e),()=>{window.removeEventListener("profilehub-state-changed",e)}},getCurrentPosition:()=>a?.state?.ui?.position||"top-right",getCurrentState:()=>a?.state?.ui?.hubState||"minimized",isModalOpen:o=>{if(!a)return!1;const{ui:e}=a.state;switch(o){case"expanded":return e.hubState==="expanded";case"chatbot":return e.hubState==="chatbot-active";case"customization":return e.customizationState==="open";default:return!1}}};window.openChatbot=()=>a?.toggleChatbot();window.openWorkflowManager=()=>{const o=document.getElementById("workflowManagerModal");o&&(o.style.display="block",document.body.style.overflow="hidden")};window.initProfileHub=()=>{console.log("[PROFILE HUB] Manual initialization triggered");try{a?console.log("[PROFILE HUB] ProfileHub already initialized"):(d(),a=new l,window.profileHubManager=a,console.log("[PROFILE HUB] Manual initialization successful"))}catch(o){console.error("[PROFILE HUB] Manual initialization failed:",o)}};window.openAuthModal=(o="login")=>{const e=document.getElementById("authModal");if(e){e.style.display="block",document.body.style.overflow="hidden";const t=document.getElementById("loginForm"),i=document.getElementById("signUpForm"),n=document.getElementById("forgotPasswordForm"),s=document.getElementById("authModalTitle");o==="signup"?(t.style.display="none",i.style.display="block",n.style.display="none",s.textContent="Sign Up"):o==="forgot"?(t.style.display="none",i.style.display="none",n.style.display="block",s.textContent="Reset Password"):(t.style.display="block",i.style.display="none",n.style.display="none",s.textContent="Login")}};console.log("[PROFILE HUB] ProfileHub module loaded successfully");setTimeout(()=>{if(!a){console.log("[PROFILE HUB] Timeout-based initialization triggered");try{const o=document.getElementById("profileHubContainer");o&&!o.querySelector("#profileHub")&&(console.log("[PROFILE HUB] Creating ProfileHub via timeout fallback"),d(),a=new l,window.profileHubManager=a,console.log("[PROFILE HUB] Timeout-based initialization successful"))}catch(o){console.error("[PROFILE HUB] Timeout-based initialization failed:",o)}}},2e3);window.repositionOrbToTopLeft=()=>{console.log("[PROFILE HUB DEBUG] Repositioning orb to top-left"),document.querySelector(".floating-orb-container")?(document.documentElement.style.setProperty("--orb-left","20px"),document.documentElement.style.setProperty("--orb-top","20px"),window.innerWidth<=768&&(document.documentElement.style.setProperty("--orb-left","15px"),document.documentElement.style.setProperty("--orb-top","15px")),console.log("[PROFILE HUB DEBUG] Orb repositioned to top-left successfully")):console.warn("[PROFILE HUB DEBUG] Orb container not found")};window.restoreProfileHub=()=>{console.log("[PROFILE HUB EMERGENCY] Restoring ProfileHub..."),d(),a||(a=new l,window.profileHubManager=a,console.log("[PROFILE HUB EMERGENCY] Manager created"));const o=document.getElementById("profileHub");o?(o.style.display="block",o.style.opacity="1",o.style.visibility="visible",o.style.position="fixed",o.style.top="20px",o.style.right="20px",o.style.zIndex="1000",console.log("[PROFILE HUB EMERGENCY] ProfileHub restored and visible!")):console.error("[PROFILE HUB EMERGENCY] Failed to restore ProfileHub")};window.testSlidingModal=()=>{console.log("[PROFILE HUB DEBUG] Testing sliding modal animation");const o=document.getElementById("hubCustomizationPanel");o?(o.classList.toggle("active"),console.log("[PROFILE HUB DEBUG] Sliding modal animation toggled")):console.warn("[PROFILE HUB DEBUG] Customization panel not found")};window.testProfileHubButtons=()=>{console.log("[PROFILE HUB DEBUG] Testing button functionality manually");const o={hubToggle:document.getElementById("hubToggleBtn"),chatbotToggle:document.getElementById("hubChatbotToggle"),customizeToggle:document.getElementById("hubCustomizeToggle"),authToggle:document.getElementById("hubAuthToggle")};Object.entries(o).forEach(([e,t])=>{if(t){console.log(`[PROFILE HUB DEBUG] Testing ${e} button...`);try{const i=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});t.dispatchEvent(i),console.log(`[PROFILE HUB DEBUG] ${e} button click simulated successfully`)}catch(i){console.error(`[PROFILE HUB DEBUG] Error testing ${e} button:`,i)}}else console.warn(`[PROFILE HUB DEBUG] ${e} button not found`)})};window.testProfileHubDropdown=()=>{console.log("[PROFILE HUB DEBUG] Testing dropdown functionality...");const o=document.getElementById("profileHub"),e=document.getElementById("hubExpandedContent"),t=document.getElementById("hubToggleBtn");if(console.log("Elements found:"),console.log(`  ProfileHub: ${!!o}`),console.log(`  Expanded Content: ${!!e}`),console.log(`  Toggle Button: ${!!t}`),o&&console.log(`  Current data-state: ${o.getAttribute("data-state")}`),e){const i=window.getComputedStyle(e);console.log(`  Expanded content display: ${i.display}`),console.log(`  Expanded content visibility: ${i.visibility}`),console.log(`  Expanded content opacity: ${i.opacity}`)}return window.profileHubManager?(console.log("[PROFILE HUB DEBUG] Testing manual toggle..."),window.profileHubManager.toggleHub()):console.warn("[PROFILE HUB DEBUG] ProfileHub manager not available"),e&&console.log("Expanded content classes:",e.className),{profileHub:!!o,expandedContent:!!e,toggleBtn:!!t,manager:!!window.profileHubManager}};window.diagnoseProfileIssues=()=>{console.log("[PROFILE HUB DEBUG] Diagnosing profile connection issues...");const o={timestamp:new Date().toISOString(),profileHubContainer:!!document.getElementById("profileHubContainer"),profileHub:!!document.getElementById("profileHub"),profileHubManager:!!window.profileHubManager,authUser:!!window.socialAuth?.currentUser,firebaseAuth:!!window.auth?.currentUser,widgetDisplay:!!window.widgetDisplay,firestoreRules:"Check Firebase Console for updated rules",networkStatus:navigator.onLine?"online":"offline"};return console.log("[PROFILE HUB DEBUG] Diagnosis results:",o),o.profileHubContainer||console.error("[PROFILE HUB DEBUG] Missing profileHubContainer - this is critical!"),o.profileHub||console.error("[PROFILE HUB DEBUG] Missing profileHub element - HTML may not have loaded"),o.profileHubManager||console.error("[PROFILE HUB DEBUG] ProfileHub manager not initialized"),!o.authUser&&!o.firebaseAuth&&console.warn("[PROFILE HUB DEBUG] No authenticated user found"),o};window.reinitializeProfileHub=async()=>{if(console.log("[PROFILE HUB DEBUG] Force reinitializing ProfileHub..."),window.profileHubManager)try{window.profileHubManager.destroy()}catch(e){console.warn("[PROFILE HUB DEBUG] Error destroying existing manager:",e)}const o=document.getElementById("profileHubContainer");o&&(o.innerHTML=""),await u(),console.log("[PROFILE HUB DEBUG] Reinitialization complete")};window.showProfileHub=()=>{const o=document.getElementById("profileHub"),e=document.getElementById("profileHubContainer");o?(o.classList.remove("drawer-hidden"),o.style.display="block !important",o.style.opacity="1",o.style.transform="translateX(0)",o.style.pointerEvents="auto",o.setAttribute("data-state","visible"),console.log("[PROFILE HUB DEBUG] ProfileHub forced to show"),console.log(`[PROFILE HUB DEBUG] Screen width: ${window.innerWidth}px`),console.log(`[PROFILE HUB DEBUG] ProfileHub display: ${window.getComputedStyle(o).display}`)):console.log("[PROFILE HUB DEBUG] ProfileHub element not found"),e&&(e.style.pointerEvents="auto",console.log("[PROFILE HUB DEBUG] Container pointer events enabled"))};window.checkProfileHubDOM=()=>{console.log("=== PROFILE HUB DOM CHECK ===");const o={profileHub:document.getElementById("profileHub"),hubToggleBtn:document.getElementById("hubToggleBtn"),hubAuthToggle:document.getElementById("hubAuthToggle"),hubChatbotToggle:document.getElementById("hubChatbotToggle"),hubUserAvatar:document.getElementById("hubUserAvatar")};return Object.entries(o).forEach(([e,t])=>{t?(console.log(`✅ ${e}: Found`,t),console.log(`   - Clickable: ${t.style.pointerEvents!=="none"}`),console.log(`   - Visible: ${t.offsetParent!==null}`)):console.log(`❌ ${e}: Not found`)}),o};window.checkZIndexConflicts=()=>{console.log("=== Z-INDEX CONFLICT CHECK ==="),[{name:"ProfileHub",selector:"#profileHub"},{name:"ProfileHub Container",selector:"#profileHubContainer"},{name:"Drawer Toggle",selector:".profile-hub-drawer-toggle"},{name:"Chat Drawer",selector:".chat-drawer"},{name:"Sidebar",selector:".sidebar-nav"},{name:"Modal",selector:".modal"}].forEach(({name:i,selector:n})=>{const s=document.querySelector(n);if(s){const r=window.getComputedStyle(s).zIndex;console.log(`${i}: z-index = ${r}`)}else console.log(`${i}: Not found`)});const e=document.getElementById("profileHub"),t=document.getElementById("profileHubContainer");e&&(e.style.zIndex="100080",console.log("✅ ProfileHub z-index set to 100080")),t&&(t.style.zIndex="100080",console.log("✅ Container z-index set to 100080"))};window.checkScreenSizeAndVisibility=()=>{console.log("=== SCREEN SIZE & VISIBILITY CHECK ===");const o=window.innerWidth,e=document.getElementById("profileHub");if(console.log(`Screen width: ${o}px`),console.log(`Is mobile (≤768px): ${o<=768}`),console.log(`Is small mobile (≤480px): ${o<=480}`),e){const t=window.getComputedStyle(e),i=e.getBoundingClientRect();console.log("ProfileHub status:"),console.log(`  - Display: ${t.display}`),console.log(`  - Visibility: ${t.visibility}`),console.log(`  - Opacity: ${t.opacity}`),console.log(`  - Transform: ${t.transform}`),console.log(`  - Position: ${i.left}, ${i.top}`),console.log(`  - Size: ${i.width} × ${i.height}`),console.log(`  - Data state: ${e.getAttribute("data-state")}`)}else console.log("❌ ProfileHub element not found")};function y(){const o=document.getElementById("profileHubContainer");if(!o)return;const e=()=>{const t=window.innerWidth<=768,i=window.innerWidth<=1024;t?(o.style.top="auto",o.style.right="10px",o.style.bottom="10px",o.style.left="auto",o.style.transform="scale(0.9)",o.style.transformOrigin="bottom right"):i?(o.style.top="15px",o.style.right="15px",o.style.bottom="auto",o.style.left="auto",o.style.transform="scale(0.95)",o.style.transformOrigin="top right"):(o.style.top="20px",o.style.right="20px",o.style.bottom="auto",o.style.left="auto",o.style.transform="scale(1)",o.style.transformOrigin="top right")};e(),window.addEventListener("resize",e),console.log("[PROFILE HUB] Mobile responsive positioning set up")}function H(){const o=document.getElementById("profileHub");if(!o)return;o.addEventListener("touchstart",i=>{i.target.classList.add("touch-active")},{passive:!0}),o.addEventListener("touchend",i=>{i.target.classList.remove("touch-active")},{passive:!0});let e=0;o.addEventListener("touchend",i=>{const n=new Date().getTime();n-e<=300&&i.preventDefault(),e=n},!1),o.querySelectorAll("button, .hub-control-btn, .nav-link").forEach(i=>{i.style.minHeight="44px",i.style.minWidth="44px"}),console.log("[PROFILE HUB] Mobile event listeners set up")}
