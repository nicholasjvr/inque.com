import{a as s,d as r}from"./index-CLYW6X3l.js";import{onAuthStateChanged as l,getRedirectResult as d,GithubAuthProvider as u,signInWithPopup as h,signInWithRedirect as g,signOut as I}from"https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";import{doc as p,getDoc as A,serverTimestamp as a,setDoc as w}from"https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/11.10.0/firebase-analytics.js";import"https://www.gstatic.com/firebasejs/11.10.0/firebase-storage.js";import"https://www.gstatic.com/firebasejs/11.10.0/firebase-functions.js";class f{constructor(){this.sections=["home","guides","showcase","inspiration","tools","projects"],this.currentSection="home",this.isInitialized=!1,console.log("[NAVIGATION] Navigation Manager initialized")}async init(){try{this.setupNavigation(),this.setupAuthIntegration(),this.handleRedirectResult(),this.isInitialized=!0,console.log("[NAVIGATION] Navigation system ready")}catch(e){console.error("[NAVIGATION] Failed to initialize navigation",e)}}setupNavigation(){const e=document.querySelectorAll(".category-btn");console.log(`ðŸ”§ Setting up ${e.length} navigation buttons`),e.forEach((t,o)=>{console.log(`ðŸ”§ Button ${o+1}:`,t.dataset.category,t),t.addEventListener("click",i=>{i.preventDefault();const n=t.dataset.category;console.log(`ðŸ”§ Navigation clicked: ${n}`),this.navigateToSection(n)})}),console.log("[NAVIGATION] Navigation buttons configured")}setupAuthIntegration(){l(s,async t=>{t?await this.handleUserLogin(t):this.handleUserLogout()});const e=document.getElementById("authBtn");e&&e.addEventListener("click",t=>{t.preventDefault(),this.handleAuthButtonClick()}),console.log("[NAVIGATION] Auth integration configured")}async handleRedirectResult(){try{await d(s)&&(console.log("[NAVIGATION] Redirect authentication successful"),this.showToast("Login successful! Welcome!","success"))}catch(e){console.error("[NAVIGATION] Redirect result error",e)}}async handleUserLogin(e){try{window.vibeCoders=window.vibeCoders||{},window.vibeCoders.currentUser=e,window.vibeCoders.isAuthenticated=!0,await this.loadUserProfile(e),this.updateUIForAuthenticatedUser(e),this.showToast(`Welcome back, ${e.displayName||"Vibe-coder"}! ðŸš€`,"success"),console.log("[NAVIGATION] User logged in successfully",{uid:e.uid})}catch(t){console.error("[NAVIGATION] Error handling user login",t)}}handleUserLogout(){window.vibeCoders=window.vibeCoders||{},window.vibeCoders.currentUser=null,window.vibeCoders.isAuthenticated=!1,this.updateUIForGuest(),console.log("[NAVIGATION] User logged out")}async loadUserProfile(e){try{const t=p(r,"users",e.uid),o=await A(t);if(o.exists())window.vibeCoders.userProfile=o.data(),console.log("[NAVIGATION] User profile loaded");else{const i={uid:e.uid,displayName:e.displayName,email:e.email,photoURL:e.photoURL,bio:"",skills:[],socialLinks:{},stats:{projectsCreated:0,guidesWritten:0,toolsShared:0,reputation:0},createdAt:a(),updatedAt:a()};await w(t,i),window.vibeCoders.userProfile=i,console.log("[NAVIGATION] New user profile created")}}catch(t){console.error("[NAVIGATION] Error loading user profile",t)}}updateUIForAuthenticatedUser(e){const t=document.getElementById("authBtn"),o=document.getElementById("userName"),i=document.getElementById("userAvatar");t&&(t.textContent="LOGOUT",t.removeEventListener("click",this.handleAuthButtonClick),t.addEventListener("click",n=>{n.preventDefault(),this.handleLogout()})),o&&(o.textContent=e.displayName||"User"),i&&(e.photoURL?(i.style.backgroundImage=`url(${e.photoURL})`,i.innerHTML=""):i.innerHTML="ðŸ‘¤")}updateUIForGuest(){const e=document.getElementById("authBtn"),t=document.getElementById("userName"),o=document.getElementById("userAvatar");e&&(e.textContent="LOGIN",e.removeEventListener("click",this.handleLogout),e.addEventListener("click",i=>{i.preventDefault(),this.handleAuthButtonClick()})),t&&(t.textContent="Guest"),o&&(o.style.backgroundImage="",o.innerHTML="ðŸ‘¤")}async handleAuthButtonClick(){window.vibeCoders?.isAuthenticated?await this.handleLogout():await this.handleLogin()}async handleLogin(){try{const e=new u;try{const t=await h(s,e);console.log("[NAVIGATION] Login successful via popup"),this.showToast("Login successful! Welcome!","success")}catch(t){if(console.warn("[NAVIGATION] Popup blocked, trying redirect:",t.code),t.code==="auth/popup-blocked"||t.code==="auth/cancelled-popup-request"){console.log("[NAVIGATION] Switching to redirect authentication"),this.showToast("Popup blocked. Redirecting to GitHub for authentication...","info",3e3),await g(s,e);return}throw t}}catch(e){console.error("[NAVIGATION] Login error",e);let t="Authentication failed. Please try again.";e.code==="auth/operation-not-allowed"?t="GitHub authentication is not enabled. Please contact support.":e.code==="auth/popup-blocked"?t="Popup blocked. Please allow popups and try again.":e.code==="auth/cancelled-popup-request"&&(t="Authentication cancelled. Please try again."),this.showToast(t,"error")}}async handleLogout(){try{await I(s),this.showToast("Logged out successfully","info"),console.log("[NAVIGATION] Logout successful")}catch(e){console.error("[NAVIGATION] Logout error",e)}}navigateToSection(e){if(console.log(`ðŸ”§ Navigating to section: ${e}`),!this.sections.includes(e)){console.warn("[NAVIGATION] Invalid section:",e);return}this.sections.forEach(o=>{const i=document.getElementById(`${o}-section`);i&&(i.style.display="none",console.log(`ðŸ”§ Hiding section: ${o}`))});const t=document.getElementById(`${e}-section`);t&&(t.style.display="block",this.currentSection=e,console.log(`ðŸ”§ Showing section: ${e}`),document.querySelectorAll(".category-btn").forEach(i=>{i.classList.remove("neo-brutalist-accent"),i.dataset.category===e&&i.classList.add("neo-brutalist-accent")}),this.handleSectionInit(e),console.log(`[NAVIGATION] Navigated to ${e} section`))}handleSectionInit(e){switch(e){case"projects":this.initProjectsSection();break;case"tools":this.initToolsSection();break;case"guides":this.initGuidesSection();break;case"showcase":this.initShowcaseSection();break;case"inspiration":this.initInspirationSection();break}}initProjectsSection(){console.log("[NAVIGATION] Initializing projects section"),window.timelineManager&&console.log("[NAVIGATION] Timeline manager found, integrating...")}initToolsSection(){console.log("[NAVIGATION] Initializing tools section");const e=document.querySelectorAll(".tool-category");e.forEach(t=>{t.addEventListener("click",o=>{o.preventDefault();const i=t.dataset.category;this.filterTools(i),e.forEach(n=>n.classList.remove("active")),t.classList.add("active")})})}filterTools(e){document.querySelectorAll(".tool-card").forEach(o=>{(o.dataset.categories?.split(" ")||[]).includes(e)?o.style.display="block":o.style.display="none"}),console.log(`[NAVIGATION] Tools filtered to category: ${e}`)}initGuidesSection(){console.log("[NAVIGATION] Initializing guides section");const e=document.getElementById("createGuideBtn");e&&e.addEventListener("click",t=>{t.preventDefault(),this.handleCreateGuide()})}initShowcaseSection(){console.log("[NAVIGATION] Initializing showcase section");const e=document.getElementById("addToShowcaseBtn");e&&e.addEventListener("click",t=>{t.preventDefault(),this.handleAddToShowcase()})}initInspirationSection(){console.log("[NAVIGATION] Initializing inspiration section")}async handleCreateGuide(){if(!window.vibeCoders?.isAuthenticated){this.showToast("Please log in to create guides","warning");return}this.showToast("Guide creation feature coming soon!","info")}async handleAddToShowcase(){if(!window.vibeCoders?.isAuthenticated){this.showToast("Please log in to add to showcase","warning");return}this.showToast("Showcase addition feature coming soon!","info")}showToast(e,t="info"){if(window.showToast)window.showToast(e,t);else{const o=document.createElement("div");o.className=`toast ${t}`,o.innerHTML=`
        <span class="toast-message">${e}</span>
        <button class="toast-close">&times;</button>
      `,(document.getElementById("toast-container")||document.body).appendChild(o),setTimeout(()=>{o.parentNode&&o.parentNode.removeChild(o)},5e3)}}getCurrentSection(){return this.currentSection}isUserAuthenticated(){return window.vibeCoders?.isAuthenticated||!1}getCurrentUser(){return window.vibeCoders?.currentUser||null}}const c=new f;window.navigationManager=c;document.addEventListener("DOMContentLoaded",()=>{c.init()});export{c as default};
