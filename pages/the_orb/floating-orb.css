/* ========== Floating Orb: Simplified Positioning ========== */

/* WebGL layer sits behind the CSS orb */
.orb-3d-layer {
    position: absolute;
    top: 50%;
    left: 50%;
    width: var(--orb-size);
    height: var(--orb-size);
    transform: translate(-50%, -50%);
    pointer-events: none;
    z-index: 1;
}

:root {
    /* Simple orb sizing */
    --orb-size: 130px;
    --orbit-size: 280px;

    /* Colors */
    --orb-primary: #00e5ff;
    --orb-secondary: #b400ff;
    --orb-glow: rgba(0, 229, 255, .45);

    /* UI */
    --z-orb: 100040;
}

/* Simple responsive sizing */
@media (max-width: 768px) {
    :root {
        --orb-size: 110px;
        --orbit-size: 240px;
    }
}


/* Wrapper sets the 3D stage - Fixed positioning */
.floating-orb-wrapper {
    position: relative;
    width: var(--orbit-size);
    height: var(--orbit-size);
    z-index: var(--z-orb);
    pointer-events: none;
    perspective: 700px;
    transform-style: preserve-3d;
    /* Fixed positioning - never moves with scroll */
    margin: 0;
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    /* Ensure it stays put */
    transform: none !important;
    pointer-events: none;
    overflow: visible;
}

/* =====================
   Orb Navigator (Orbiting links)
   ===================== */
.orb-nav-container.rotating {
    /* JS controls the orbit to create a Saturn-like horizontal ring */
    animation: none;
}

/* Saturn-like equatorial ring */
.orb-scroll-line {
    position: absolute;
    top: 50%;
    left: 50%;
    width: calc(var(--orbit-size) + 80px);
    height: calc(var(--orbit-size) + 80px);
    transform: translate(-50%, -50%) scaleY(0.15) rotateZ(var(--scroll-rotation, 0deg));
    border: 2px solid transparent;
    border-radius: 50%;
    pointer-events: none;
    z-index: 1;
    background: conic-gradient(from 0deg,
            rgba(0, 240, 255, 0.9) 0deg,
            rgba(0, 240, 255, 0.6) 60deg,
            rgba(180, 0, 255, 0.7) 120deg,
            rgba(255, 107, 53, 0.6) 180deg,
            rgba(180, 0, 255, 0.7) 240deg,
            rgba(0, 240, 255, 0.6) 300deg,
            rgba(0, 240, 255, 0.9) 360deg);
    -webkit-mask:
        radial-gradient(ellipse at center, transparent calc(50% - 2px),
            black calc(50% - 2px),
            black calc(50% + 2px),
            transparent calc(50% + 2px));
    mask:
        radial-gradient(ellipse at center, transparent calc(50% - 2px),
            black calc(50% - 2px),
            black calc(50% + 2px),
            transparent calc(50% + 2px));
    transition: opacity 0.3s ease;
    box-shadow: 0 0 20px rgba(0, 240, 255, 0.3);
}

/* Lock points on the scroll line */
.orb-scroll-line::before {
    content: '';
    position: absolute;
    top: calc(50% - var(--lock-point-size) / 2);
    left: calc(50% - var(--lock-point-size) / 2);
    width: var(--lock-point-size);
    height: var(--lock-point-size);
    background: var(--orb-primary);
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(0, 240, 255, 0.6);
    transform: translateX(calc(var(--orbit-size) / 2));
    animation: lock-point-pulse 2s ease-in-out infinite;
}

@keyframes lock-point-pulse {

    0%,
    100% {
        opacity: 0.6;
        transform: translateX(calc(var(--orbit-size) / 2)) scale(1);
    }

    50% {
        opacity: 1;
        transform: translateX(calc(var(--orbit-size) / 2)) scale(1.2);
    }
}

/* Lock snap animation for satisfying feedback */
.floating-orb-wrapper.lock-snap {
    transform: translate(-50%, -50%) scale(1.02);
    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.floating-orb-wrapper.lock-snap .floating-orb {
    filter: brightness(1.2) saturate(1.3);
    box-shadow:
        0 0 20px var(--orb-primary),
        0 0 40px rgba(0, 240, 255, 0.4),
        0 0 60px rgba(180, 0, 255, 0.2);
    transition: all 0.2s ease;
}

.floating-orb-wrapper.lock-snap .orb-scroll-line {
    opacity: 1 !important;
    transform: translate(-50%, -50%) scaleY(0.3) rotateZ(var(--scroll-rotation, 0deg)) scale(1.05);
    transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.orb-nav-container::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    transform: translate(-50%, -50%) scaleY(0.32);
    border: 1px solid rgba(0, 240, 255, 0.2);
    border-radius: 50%;
    box-shadow: inset 0 0 12px rgba(0, 240, 255, 0.15);
    pointer-events: none;
}

.orb-nav-item {
    --angle: 0deg;
    /* base angle set by JS */
    --nav-radius: calc(var(--orbit-size) / 2.2);
    --x: 0px;
    /* computed by JS */
    --y: 0px;
    /* computed by JS */
    position: absolute;
    top: 50%;
    left: 50%;
    width: 56px;
    height: 56px;
    transform: translate(-50%, -50%) translate(var(--x), var(--y));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: auto;
    color: #b7f7ff;
    text-decoration: none;
    background: rgba(10, 20, 28, 0.6);
    border: 1px solid rgba(0, 240, 255, 0.35);
    box-shadow: 0 0 10px rgba(0, 240, 255, 0.25);
    transition: transform .2s ease, box-shadow .2s ease, background .2s ease, opacity .2s ease, filter .2s ease;
    backdrop-filter: blur(6px);
    z-index: 1;
}

.orb-nav-item:hover {
    transform: translate(-50%, -50%) translate(calc(var(--x) + 6px), var(--y));
    background: rgba(0, 240, 255, 0.12);
    box-shadow: 0 0 16px rgba(0, 240, 255, 0.4);
}

.orb-nav-item.in-front {
    z-index: 6;
    opacity: 1;
    filter: none;
}

.orb-nav-item:not(.in-front) {
    opacity: .6;
    filter: brightness(.95) saturate(.9);
    transform: translate(-50%, -50%) translate(var(--x), var(--y)) scale(.88);
}

.orb-nav-item:focus-visible {
    outline: 3px solid var(--primary-neon);
    outline-offset: 2px;
    box-shadow: 0 0 0 6px rgba(0, 240, 255, 0.25);
}

@media (max-width: 768px) {
    .orb-nav-item {
        width: 52px;
        height: 52px;
        touch-action: manipulation;
        -webkit-tap-highlight-color: rgba(0, 240, 255, 0.3);
        /* Better mobile touch targets */
        min-height: 44px;
        min-width: 44px;
        /* Ensure visibility on mobile */
        opacity: 1;
        z-index: 10;
        /* Better touch interaction */
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .orb-nav-container {
        /* slightly tighter orbit on mobile */
        --nav-radius: calc(var(--orbit-size) / 2.3);
    }

    /* Mobile-specific orb improvements */
    .floating-orb {
        /* Slightly smaller on mobile but still prominent */
        width: calc(var(--orb-size) * 0.9);
        height: calc(var(--orb-size) * 0.9);
        /* Enhanced glow for mobile */
        box-shadow:
            0 0 20px rgba(0, 229, 255, 0.7),
            0 0 40px rgba(0, 229, 255, 0.5),
            0 0 60px rgba(0, 229, 255, 0.3),
            inset 0 0 20px rgba(255, 255, 255, 0.1);
    }

    .floating-orb:hover {
        /* Reduced scale on mobile to prevent overflow */
        transform: translate(-50%, -50%) scale(1.02) !important;
    }

    /* Mobile navigation enhancements */
    .orb-nav-item:active {
        transform: translate(-50%, -50%) translate(var(--x), var(--y)) scale(0.95);
        background: rgba(0, 240, 255, 0.2);
    }

    /* Ensure navigation buttons are always accessible on mobile */
    .orb-nav-item {
        pointer-events: auto !important;
        touch-action: manipulation;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        /* Enhanced mobile interaction */
        -webkit-tap-highlight-color: rgba(0, 240, 255, 0.4);
        /* Prevent text selection */
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
    }

    /* Mobile-specific orb enhancements */
    .floating-orb {
        /* Add touch-friendly interaction */
        -webkit-tap-highlight-color: transparent;
    }

    /* Ensure proper mobile rendering */
    .floating-orb-wrapper {
        /* Prevent mobile browser interference */
        -webkit-transform: translate3d(0, 0, 0);
        transform: translate3d(0, 0, 0);
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        -webkit-perspective: 1000;
        perspective: 1000;
    }
}

/* ========== The Orb ========== */
.floating-orb {
    position: relative;
    top: 50%;
    left: 50%;
    width: var(--orb-size);
    height: var(--orb-size);
    transform: translate(-50%, -50%);
    border-radius: 50%;
    pointer-events: auto;
    cursor: pointer;
    z-index: 100003;
    will-change: transform, filter;
}



/* Enhanced orb with beautiful gradients and glow */
.floating-orb {
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    transform: translate(-50%, -50%);
    /* Ensure orb never moves */
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    /* Beautiful orb styling with enhanced gradients */
    background:
        radial-gradient(circle at 25% 25%,
            rgba(0, 255, 255, 1) 0%,
            rgba(0, 229, 255, 0.95) 15%,
            rgba(0, 195, 255, 0.85) 35%,
            rgba(0, 150, 255, 0.75) 55%,
            rgba(0, 120, 220, 0.65) 75%,
            rgba(0, 100, 200, 0.55) 100%),
        radial-gradient(circle at 75% 75%,
            rgba(180, 0, 255, 0.3) 0%,
            rgba(180, 0, 255, 0.1) 50%,
            transparent 100%),
        linear-gradient(135deg,
            rgba(255, 255, 255, 0.1) 0%,
            transparent 50%,
            rgba(0, 229, 255, 0.1) 100%);
    box-shadow:
        0 0 40px rgba(0, 229, 255, 0.8),
        0 0 80px rgba(0, 229, 255, 0.6),
        0 0 120px rgba(0, 229, 255, 0.4),
        0 0 160px rgba(0, 229, 255, 0.2),
        inset 0 0 40px rgba(255, 255, 255, 0.15),
        inset 0 0 80px rgba(0, 229, 255, 0.25),
        inset 0 0 120px rgba(0, 229, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.3);
    /* Add subtle animation */
    animation: orb-pulse 4s ease-in-out infinite;
}

.floating-orb:hover {
    transform: translate(-50%, -50%) scale(1.05) !important;
    box-shadow:
        0 0 50px rgba(0, 229, 255, 1.0),
        0 0 100px rgba(0, 229, 255, 0.8),
        0 0 150px rgba(0, 229, 255, 0.6),
        0 0 200px rgba(0, 229, 255, 0.4),
        inset 0 0 50px rgba(255, 255, 255, 0.2),
        inset 0 0 100px rgba(0, 229, 255, 0.35),
        inset 0 0 150px rgba(0, 229, 255, 0.15);
    animation: orb-pulse-fast 2s ease-in-out infinite;
    /* Enhanced hover effect */
    background:
        radial-gradient(circle at 20% 20%,
            rgba(0, 255, 255, 1) 0%,
            rgba(0, 229, 255, 0.98) 15%,
            rgba(0, 195, 255, 0.9) 35%,
            rgba(0, 150, 255, 0.8) 55%,
            rgba(0, 120, 220, 0.7) 75%,
            rgba(0, 100, 200, 0.6) 100%),
        radial-gradient(circle at 80% 80%,
            rgba(180, 0, 255, 0.4) 0%,
            rgba(180, 0, 255, 0.15) 50%,
            transparent 100%),
        linear-gradient(135deg,
            rgba(255, 255, 255, 0.15) 0%,
            transparent 50%,
            rgba(0, 229, 255, 0.15) 100%);
}

/* Subtle pulsing animation */
@keyframes orb-pulse {

    0%,
    100% {
        filter: brightness(1.0) saturate(1.0);
    }

    50% {
        filter: brightness(1.1) saturate(1.1);
    }
}

@keyframes orb-pulse-fast {

    0%,
    100% {
        filter: brightness(1.2) saturate(1.2);
    }

    50% {
        filter: brightness(1.3) saturate(1.3);
    }
}

/* Ensure orb container stays fixed */
#orb-container {
    position: relative !important;
    overflow: visible !important;
    transform: none !important;
}

/* Remove idle animation by default */
.floating-orb.idle {
    animation: none;
    filter: brightness(1.0);
}


/* nav badges (for DM/AI/Space) */
.orb-nav-item[data-badge]:after {
    content: attr(data-badge);
    position: absolute;
    top: -6px;
    right: -6px;
    min-width: 18px;
    height: 18px;
    padding: 0 4px;
    border-radius: 9px;
    font-size: 11px;
    line-height: 18px;
    text-align: center;
    color: #031417;
    background: #00e5ff;
    border: 1px solid rgba(255, 255, 255, .25);
    box-shadow: 0 0 10px rgba(0, 229, 255, .45);
}

/* Universal input bar - simple positioning */
.orb-input-wrap {
    position: fixed;
    left: 50%;
    bottom: 20px;
    transform: translateX(-50%);
    width: min(500px, 90vw);
    pointer-events: auto;
    z-index: 10050;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.orb-input {
    display: flex !important;
    gap: 8px !important;
    align-items: center !important;
    background: rgba(12, 18, 24, .85) !important;
    border: 1px solid rgba(0, 240, 255, .2) !important;
    border-radius: 14px !important;
    padding: 8px 10px !important;
    box-shadow: 0 10px 24px rgba(0, 0, 0, .35) !important;
    backdrop-filter: blur(8px) !important;
    transition: all 0.3s ease !important;
    cursor: pointer !important;
    position: relative !important;
    width: 100% !important;
    min-height: 40px !important;
    box-sizing: border-box !important;
}

.orb-input:hover {
    border-color: rgba(0, 240, 255, .4);
    box-shadow: 0 10px 24px rgba(0, 0, 0, .45), 0 0 20px rgba(0, 240, 255, .1);
}

.orb-input-wrap.dock-triggered .orb-input {
    border-color: rgba(0, 240, 255, .6);
    box-shadow: 0 10px 24px rgba(0, 0, 0, .45), 0 0 20px rgba(0, 240, 255, .2);
    transform: scale(1.02);
}

.orb-input-wrap.dock-triggered .orb-input::before {
    content: "💬";
    position: absolute;
    left: -30px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 16px;
    opacity: 0.8;
    animation: input-pulse 2s ease-in-out infinite;
}

@keyframes input-pulse {

    0%,
    100% {
        opacity: 0.8;
        transform: translateY(-50%) scale(1);
    }

    50% {
        opacity: 1;
        transform: translateY(-50%) scale(1.1);
    }
}

.orb-input input[type="text"] {
    flex: 1;
    background: transparent !important;
    border: 0 !important;
    outline: 0 !important;
    color: #d9fbff !important;
    font-size: 14px !important;
    cursor: pointer !important;
    padding: 0 !important;
    margin: 0 !important;
    box-shadow: none !important;
    font-family: inherit !important;
}

.orb-input input[type="text"]:focus {
    cursor: text !important;
    background: transparent !important;
    border: 0 !important;
    outline: 0 !important;
    box-shadow: none !important;
}

.orb-input input[type="text"]::placeholder {
    color: #7bb3c4 !important;
    opacity: 1 !important;
}

.orb-input .send-btn {
    border: 0 !important;
    background: rgba(0, 240, 255, .15) !important;
    color: #b7f7ff !important;
    padding: 6px 10px !important;
    border-radius: 10px !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    min-width: auto !important;
    height: auto !important;
    line-height: 1 !important;
}

.orb-input .send-btn:hover {
    filter: brightness(1.1) !important;
    background: rgba(0, 240, 255, .25) !important;
    transform: none !important;
}

.orb-input .send-btn:active {
    transform: scale(0.98) !important;
}

/* star notifications on the ring */
.orb-star-layer {
    position: absolute;
    top: 50%;
    left: 50%;
    width: var(--orbit-size);
    height: var(--orbit-size);
    transform: translate(-50%, -50%);
    pointer-events: none;
    z-index: 5;
}

.orb-star {
    --angle: 0deg;
    --radius: calc(var(--orbit-size) / 2.25);
    --x: 0px;
    --y: 0px;

    position: absolute;
    top: 50%;
    left: 50%;
    width: 12px;
    height: 12px;
    transform: translate(-50%, -50%) translate(var(--x), var(--y));
    border-radius: 50%;
    background: radial-gradient(circle at 40% 40%, #fff, #aef, #6cf 60%, transparent 70%);
    box-shadow: 0 0 10px rgba(0, 240, 255, .65), 0 0 18px rgba(180, 0, 255, .35);
    pointer-events: auto;
    transition: transform .12s ease, filter .12s ease, opacity .12s ease;
    cursor: pointer;
    will-change: transform, filter, opacity;
    z-index: 1;
}

.orb-star:hover,
.orb-star:focus-visible {
    transform: translate(-50%, -50%) translate(var(--x), var(--y)) scale(1.25);
    filter: brightness(1.15) saturate(1.1);
    outline: none;
}

@keyframes star-pulse {

    0%,
    100% {
        opacity: 0.95;
        box-shadow: 0 0 10px rgba(0, 240, 255, .65), 0 0 18px rgba(180, 0, 255, .35);
    }

    50% {
        opacity: 1;
        box-shadow: 0 0 14px rgba(0, 240, 255, .8), 0 0 24px rgba(180, 0, 255, .5);
    }
}

.orb-star {
    animation: star-pulse 2.8s ease-in-out infinite;
}

.orb-star.bloom-1 {
    --radius: calc(var(--orbit-size) / 2.18);
}

.orb-star.bloom-2 {
    --radius: calc(var(--orbit-size) / 2.10);
}

.orb-star-tip {
    position: absolute;
    min-width: 160px;
    max-width: 220px;
    padding: 8px 10px;
    border-radius: 10px;
    font-size: 12px;
    line-height: 1.25;
    color: #d9fbff;
    background: rgba(10, 18, 24, .82);
    border: 1px solid rgba(0, 240, 255, .25);
    box-shadow: 0 8px 22px rgba(0, 0, 0, .35);
    transform: translate(-50%, -100%) translateY(-10px);
    opacity: 0;
    pointer-events: none;
    transition: opacity .15s ease, transform .15s ease;
    z-index: 7;
}

.orb-star-tip.show {
    opacity: 1;
    transform: translate(-50%, -100%) translateY(-4px);
}

.orb-star-tip::after {
    content: "";
    position: absolute;
    left: 50%;
    bottom: -6px;
    transform: translateX(-50%) rotate(45deg);
    width: 10px;
    height: 10px;
    background: inherit;
    border-left: 1px solid rgba(0, 240, 255, .25);
    border-bottom: 1px solid rgba(0, 240, 255, .25);
}

/* Saturn ring glow animation */
@keyframes saturn-ring-glow {

    0%,
    100% {
        box-shadow: 0 0 20px rgba(0, 240, 255, 0.3);
        filter: brightness(1.0);
    }

    50% {
        box-shadow: 0 0 30px rgba(0, 240, 255, 0.5), 0 0 60px rgba(180, 0, 255, 0.2);
        filter: brightness(1.2);
    }
}